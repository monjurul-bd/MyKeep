<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gemini Keep PWA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined|Material+Icons" rel="stylesheet">

    <style>
        body { font-family: 'Google Sans', sans-serif; background-color: #F0F4F9; overscroll-behavior-y: contain; }
        .gemini-card { background: white; border-radius: 24px; box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24); transition: all 0.2s ease-in-out; border: 1px solid transparent; }
        .gemini-card:hover { box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23); }
        .gemini-input { background: #F0F4F9; border-radius: 12px; border: none; outline: none; transition: 0.3s; }
        .gemini-input:focus { background: #E2E7EB; box-shadow: inset 0 0 0 2px #A8C7FA; }
        .fab { position: fixed; bottom: 24px; right: 24px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 40; }
        
        /* Bottom Sheet/Menu Styles */
        .bottom-menu { position: fixed; bottom: 0; left: 0; right: 0; background: white; border-radius: 24px 24px 0 0; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); transform: translateY(100%); transition: transform 0.3s ease-in-out; z-index: 60; }
        .bottom-menu.active { transform: translateY(0); }
        .menu-item { padding: 14px 20px; display: flex; align-items: center; gap: 16px; color: #474747; font-size: 16px; font-weight: 500; }
        .menu-item:hover { background-color: #F5F5F5; }
        .menu-icon { font-size: 24px; color: #5F6368; }
        
        /* Editor Footer */
        .editor-footer { position: fixed; bottom: 0; left: 0; right: 0; background: #F0F4F9; padding: 8px 16px; display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #E0E0E0; z-index: 60; }
        .footer-icon-btn { padding: 10px; border-radius: 50%; color: #5F6368; transition: background 0.2s; }
        .footer-icon-btn:hover { background-color: #E2E7EB; color: #1F1F1F; }

        /* Hide scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="text-gray-800 h-screen flex flex-col overflow-hidden">

    <header class="p-4 flex justify-between items-center bg-[#F0F4F9] z-10">
        <div class="flex items-center gap-3">
            <span class="material-icons-outlined text-3xl text-[#0B57D0]">auto_awesome</span>
            <h1 class="text-2xl font-medium text-[#1F1F1F]">AI Notes</h1>
        </div>
        <button onclick="requestNotificationPermission()" class="text-gray-600 hover:text-[#0B57D0] p-2 rounded-full hover:bg-[#E2E7EB]">
            <span class="material-icons-outlined">notifications_active</span>
        </button>
    </header>

    <main class="flex-1 overflow-y-auto p-4 pb-28" id="note-container">
        </main>

    <button onclick="openModal()" class="fab bg-[#C3E7FF] text-[#001D35] p-4 flex items-center justify-center hover:bg-[#A8C7FA] transition-colors">
        <span class="material-icons-outlined text-3xl">add</span>
    </button>

    <div id="noteModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 transition-opacity duration-300">
        <div class="bg-white w-full h-full flex flex-col">
             <div class="flex items-center justify-between p-4 border-b border-gray-200">
                <button onclick="closeModal()" class="text-gray-600 p-2 rounded-full hover:bg-gray-100"><span class="material-icons-outlined">arrow_back</span></button>
                <div class="flex gap-2">
                    <button class="text-gray-600 p-2 rounded-full hover:bg-gray-100"><span class="material-icons-outlined">push_pin</span></button>
                    <button class="text-gray-600 p-2 rounded-full hover:bg-gray-100"><span class="material-icons-outlined">notifications_none</span></button>
                    <button class="text-gray-600 p-2 rounded-full hover:bg-gray-100"><span class="material-icons-outlined">archive</span></button>
                </div>
            </div>
            
             <div class="flex-1 overflow-y-auto p-5">
                <input type="text" id="noteTitle" placeholder="‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ (Title)" class="text-2xl font-medium text-[#1F1F1F] w-full outline-none mb-4 placeholder-gray-500 bg-transparent">
                <textarea id="noteDesc" placeholder="‡¶®‡ßã‡¶ü ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..." class="w-full h-full resize-none outline-none text-lg text-[#1F1F1F] placeholder-gray-500 bg-transparent"></textarea>
            </div>

            <div class="px-5 pb-2 hidden">
                <div class="flex items-center gap-2 bg-gray-50 p-3 rounded-xl border border-gray-100">
                    <span class="material-icons-outlined text-gray-500">alarm</span>
                    <input type="datetime-local" id="noteTime" class="bg-transparent outline-none text-sm text-gray-600 w-full">
                </div>
            </div>

            <div class="editor-footer" id="editorFooter">
                <button class="footer-icon-btn" onclick="alert('‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßá‡¶∞‡¶æ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...')"><span class="material-icons-outlined">photo_camera</span></button>
                <button class="footer-icon-btn" onclick="alert('‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø ‡¶ñ‡ßÅ‡¶≤‡¶õ‡ßá...')"><span class="material-icons-outlined">image</span></button>
                <button class="footer-icon-btn" onclick="alert('‡¶°‡ßç‡¶∞‡¶á‡¶Ç ‡¶Æ‡ßã‡¶°...')"><span class="material-icons-outlined">brush</span></button>
                <button class="footer-icon-btn" onclick="alert('‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶°‡¶ø‡¶Ç ‡¶∂‡ßÅ‡¶∞‡ßÅ...')"><span class="material-icons-outlined">mic</span></button>
                <button class="footer-icon-btn" onclick="alert('‡¶ö‡ßá‡¶ï‡¶¨‡¶ï‡ßç‡¶∏ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡ßü‡ßá‡¶õ‡ßá')"><span class="material-icons-outlined">check_box_outline_blank</span></button>
            </div>
        </div>
    </div>

    <div id="noteOptionsMenu" class="bottom-menu">
        <div class="p-4 text-center text-sm text-gray-500 border-b border-gray-100" id="menuNoteDate">‡ß®‡ßØ ‡¶°‡¶ø‡¶∏‡ßá, ‡ß®‡ß¶‡ß®‡ß´-‡¶è ‡¶è‡¶°‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá</div>
        <div class="py-2">
            <div class="menu-item" onclick="deleteCurrentNote()">
                <span class="material-icons-outlined menu-icon">delete</span>
                <span>‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶¶‡¶ø‡¶®</span>
            </div>
            <div class="menu-item" onclick="alert('‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá')">
                <span class="material-icons-outlined menu-icon">content_copy</span>
                <span>‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</span>
            </div>
             <div class="menu-item" onclick="alert('‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶®‡ßÅ')">
                <span class="material-icons-outlined menu-icon">share</span>
                <span>‡¶™‡¶æ‡¶†‡¶æ‡¶®</span>
            </div>
             <div class="menu-item" onclick="alert('‡¶∏‡¶π‡¶Ø‡ßã‡¶ó‡ßÄ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®')">
                <span class="material-icons-outlined menu-icon">person_add</span>
                <span>‡¶∏‡¶π‡¶Ø‡ßã‡¶ó‡ßÄ</span>
            </div>
             <div class="menu-item" onclick="alert('‡¶≤‡ßá‡¶¨‡ßá‡¶≤ ‡¶Æ‡ßá‡¶®‡ßÅ')">
                <span class="material-icons-outlined menu-icon">label</span>
                <span>‡¶≤‡ßá‡¶¨‡ßá‡¶≤‡¶ó‡ßÅ‡¶≤‡¶ø</span>
            </div>
             <div class="menu-item" onclick="alert('‡¶∏‡¶π‡¶æ‡ßü‡¶§‡¶æ ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞')">
                <span class="material-icons-outlined menu-icon">help_outline</span>
                <span>‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ</span>
            </div>
        </div>
    </div>
    
    <div id="menuOverlay" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50" onclick="closeNoteMenu()"></div>


    <script>
        // --- State ---
        let notes = JSON.parse(localStorage.getItem('gemini_notes')) || [];
        let currentNoteId = null; // To track which note's menu is open
        
        // --- Init ---
        document.addEventListener('DOMContentLoaded', () => {
            renderNotes();
            checkReminders();
            if (Notification.permission !== "granted") Notification.requestPermission();
        });

        // --- Functions ---
        
        // Note Editor Modal
        function openModal(noteId = null) {
            document.getElementById('noteModal').classList.remove('hidden');
            const titleInput = document.getElementById('noteTitle');
            const descInput = document.getElementById('noteDesc');
            const timeInput = document.getElementById('noteTime');

            if (noteId) {
                // Edit Mode (Logic not fully implemented in this snippet, for future)
                const note = notes.find(n => n.id === noteId);
                titleInput.value = note.title;
                descInput.value = note.desc;
                timeInput.value = note.time || '';
                currentNoteId = noteId;
            } else {
                // New Note Mode
                titleInput.value = '';
                descInput.value = '';
                timeInput.value = '';
                currentNoteId = null;
            }
            titleInput.focus();
        }

        function closeModal() {
             // Auto-save on close
            saveNote();
            document.getElementById('noteModal').classList.add('hidden');
        }

        function saveNote() {
            const title = document.getElementById('noteTitle').value.trim();
            const desc = document.getElementById('noteDesc').value.trim();
            const time = document.getElementById('noteTime').value;

            if (!title && !desc) return; // Don't save empty notes

            if (currentNoteId) {
                // Update existing note
                notes = notes.map(note => note.id === currentNoteId ? { ...note, title, desc, time, edited: Date.now() } : note);
            } else {
                 // Create new note
                const newNote = {
                    id: Date.now(),
                    title: title || 'Untitled',
                    desc: desc,
                    time: time,
                    notified: false,
                    edited: Date.now()
                };
                notes.unshift(newNote);
            }
            
            updateStorage();
            renderNotes();
        }

        function updateStorage() {
            localStorage.setItem('gemini_notes', JSON.stringify(notes));
        }

        // Note Rendering
        function renderNotes() {
            const container = document.getElementById('note-container');
            container.innerHTML = '';

            if (notes.length === 0) {
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-96 text-gray-400">
                        <span class="material-icons-outlined text-[64px] mb-4 text-[#A8C7FA]">lightbulb</span>
                        <p class="text-lg font-medium text-gray-500">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶®‡ßã‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                    </div>`;
                return;
            }

            notes.forEach(note => {
                const dateDisplay = note.time ? new Date(note.time).toLocaleString('bn-BD', {
                    weekday: 'short', month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric'
                }) : '';
                
                const timeBadge = note.time ? 
                    `<div class="inline-flex items-center gap-1 text-xs font-medium bg-[#E8F0FE] text-[#0B57D0] px-2.5 py-1 rounded-full mt-3">
                        <span class="material-icons-outlined text-[14px]">event</span> ${dateDisplay}
                     </div>` : '';

                const html = `
                    <div class="gemini-card p-5 mb-4 relative group" onclick="openModal(${note.id})">
                        <div class="flex justify-between items-start">
                            <h3 class="font-medium text-lg text-[#1F1F1F] mb-1 line-clamp-1">${note.title}</h3>
                             <button onclick="event.stopPropagation(); openNoteMenu(${note.id}, '${note.edited}')" class="text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 -mr-2 -mt-2">
                                <span class="material-icons-outlined">more_vert</span>
                            </button>
                        </div>
                        <p class="text-[#474747] whitespace-pre-wrap text-[15px] leading-relaxed line-clamp-4">${note.desc}</p>
                        ${timeBadge}
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        // Note Options Menu Logic
        function openNoteMenu(noteId, editedTimestamp) {
            currentNoteId = noteId;
            const menu = document.getElementById('noteOptionsMenu');
            const overlay = document.getElementById('menuOverlay');
            const dateEl = document.getElementById('menuNoteDate');

            const date = new Date(parseInt(editedTimestamp)).toLocaleDateString('bn-BD', {
                 day: 'numeric', month: 'short', year: 'numeric'
            });
            dateEl.textContent = `${date}-‡¶è ‡¶è‡¶°‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá`;

            menu.classList.add('active');
            overlay.classList.remove('hidden');
        }

        function closeNoteMenu() {
            document.getElementById('noteOptionsMenu').classList.remove('active');
            document.getElementById('menuOverlay').classList.add('hidden');
            currentNoteId = null;
        }

        function deleteCurrentNote() {
            if (currentNoteId) {
                notes = notes.filter(note => note.id !== currentNoteId);
                updateStorage();
                renderNotes();
                closeNoteMenu();
            }
        }


        // Reminder Logic (Same as before)
        function checkReminders() {
            setInterval(() => {
                const now = new Date().getTime();
                let updated = false;
                notes.forEach(note => {
                    if (note.time && !note.notified) {
                        const reminderTime = new Date(note.time).getTime();
                        if (reminderTime <= now && reminderTime > now - 60000) {
                            sendNotification(note.title, note.desc);
                            note.notified = true;
                            updated = true;
                        }
                    }
                });
                if (updated) updateStorage();
            }, 30000);
        }

        function sendNotification(title, body) {
            if (Notification.permission === "granted") {
                new Notification("üîî Reminder: " + title, { body: body, icon: "https://www.gstatic.com/images/branding/product/1x/keep_2020q4_48dp.png" });
            } else {
                alert(`üîî Reminder: ${title}\n${body}`);
            }
        }

        function requestNotificationPermission() {
            Notification.requestPermission().then(permission => {
                if (permission === "granted") alert("‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
            });
        }
    </script>
</body>
</html>
